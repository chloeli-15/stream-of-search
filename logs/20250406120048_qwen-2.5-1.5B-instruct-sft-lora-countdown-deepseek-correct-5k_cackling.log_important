=== GPU INFO BEFORE EVALUATION (2025-04-06 12:00:48) ===
Sun Apr  6 12:00:49 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 560.35.03              Driver Version: 560.35.03      CUDA Version: 12.6     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA GeForce RTX 3090 Ti     On  |   00000000:01:00.0 Off |                  Off |
|  0%   45C    P8             20W /  450W |     116MiB /  24564MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI        PID   Type   Process name                              GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|    0   N/A  N/A      8031      G   /usr/libexec/Xorg                              86MiB |
|    0   N/A  N/A      8057      G   /usr/bin/gnome-shell                           13MiB |
+-----------------------------------------------------------------------------------------+


=== STARTING EVALUATION ===

=== START TIME: 2025-04-06 12:00:49 ===
=== HOSTNAME: cackling ===
=== COMMAND: ssh -o ServerAliveInterval=60 cackling cd ~/projects/sos/stream-of-search && /cs/student/msc/ml/2024/ycheah/disk/miniconda3/envs/sos1/bin/python ./src/eval_custom.py --adapter 'yeok/qwen-2.5-1.5B-instruct-sft-lora-countdown-deepseek-correct-5k' -n 128 --dataset_name 'MelinaLaimon/stream-of-search-ood' --messages_field 'messages' --temperature 0.7 --batch_size 8 --ctx 8192 --gens 1 --chat_template True --experiment_name '20250406120048-distributed-eval-qwen-2.5-1.5B-instruct-sft-lora-countdown-deepseek-correct-5k' --upload_results True --wandb_project 'stream-of-search' --wandb_entity 'yeokch' ===
wandb: Using wandb-core as the SDK backend.  Please refer to https://wandb.me/wandb-core for more information.
wandb: W&B API key is configured. Use `wandb login --relogin` to force relogin
wandb: Tracking run with wandb version 0.19.8
wandb: Run data is saved locally in /cs/student/projects1/ml/2024/ycheah/projects/sos/stream-of-search/wandb/run-20250406_120201-rzyf8lvh
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run 20250406120048-distributed-eval-qwen-2.5-1.5B-instruct-sft-lora-countdown-deepseek-correct-5k
wandb: ‚≠êÔ∏è View project at https://wandb.ai/yeokch/stream-of-search
wandb: üöÄ View run at https://wandb.ai/yeokch/stream-of-search/runs/rzyf8lvh
Sliding Window Attention is enabled but not implemented for `sdpa`; unexpected results may be encountered.
2025-04-06 12:02:08,758 - INFO - We will use 90% of the memory on device 0 for storing the model, and 10% for the buffer to avoid OOM. You can set `max_memory` in to a higher value to use more memory (at your own risk).

Generating countdown_3num split:   0%|          | 0/1000 [00:00<?, ? examples/s]
Generating countdown_3num split: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1000/1000 [00:00<00:00, 3904.30 examples/s]
Generating countdown_3num split: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1000/1000 [00:00<00:00, 3762.72 examples/s]

Generating countdown_5num split:   0%|          | 0/1000 [00:00<?, ? examples/s]
Generating countdown_5num split: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1000/1000 [00:00<00:00, 13263.42 examples/s]
Keys to evaluate: ['countdown_3num', 'countdown_5num']

Map:   0%|          | 0/128 [00:00<?, ? examples/s]
Map: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 128/128 [00:00<00:00, 2256.77 examples/s]

  0%|          | 0/16 [00:00<?, ?it/s]
  6%|‚ñã         | 1/16 [13:33<3:23:19, 813.29s/it]
 12%|‚ñà‚ñé        | 2/16 [27:08<3:09:58, 814.20s/it]
 19%|‚ñà‚ñâ        | 3/16 [28:24<1:43:27, 477.49s/it]
 25%|‚ñà‚ñà‚ñå       | 4/16 [41:59<2:02:07, 610.65s/it]
 31%|‚ñà‚ñà‚ñà‚ñè      | 5/16 [55:32<2:05:20, 683.65s/it]
 38%|‚ñà‚ñà‚ñà‚ñä      | 6/16 [59:23<1:28:15, 529.59s/it]
 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 7/16 [1:09:44<1:23:55, 559.55s/it]
 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 8/16 [1:23:17<1:25:21, 640.17s/it]
 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 9/16 [1:36:50<1:20:58, 694.14s/it]
 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 10/16 [1:50:22<1:13:04, 730.77s/it]
 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 11/16 [1:51:39<44:13, 530.62s/it]  
 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 12/16 [2:05:12<41:05, 616.46s/it]
 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 13/16 [2:18:45<33:47, 675.94s/it]
 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 14/16 [2:32:18<23:54, 717.28s/it]
 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 15/16 [2:38:54<10:20, 620.49s/it]
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [2:52:27<00:00, 678.37s/it]
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [2:52:27<00:00, 646.70s/it]
Success rate for each trial: [0.7109375]

Summary:
  Best-of-1 success rate: 0.7109 (91/128)
  Mean success rate across trials: 0.7109


  0%|          | 0/16 [00:00<?, ?it/s]
  6%|‚ñã         | 1/16 [13:33<3:23:26, 813.75s/it]
 12%|‚ñà‚ñé        | 2/16 [27:07<3:09:52, 813.77s/it]
 19%|‚ñà‚ñâ        | 3/16 [40:41<2:56:19, 813.78s/it]
 25%|‚ñà‚ñà‚ñå       | 4/16 [54:15<2:42:45, 813.77s/it]
 31%|‚ñà‚ñà‚ñà‚ñè      | 5/16 [1:07:48<2:29:11, 813.78s/it]
 38%|‚ñà‚ñà‚ñà‚ñä      | 6/16 [1:21:22<2:15:37, 813.77s/it]
 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 7/16 [1:34:56<2:02:03, 813.78s/it]
 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 8/16 [1:48:30<1:48:30, 813.79s/it]
 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 9/16 [2:02:04<1:34:57, 813.92s/it]
 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 10/16 [2:15:38<1:21:23, 813.87s/it]
 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 11/16 [2:29:11<1:07:49, 813.84s/it]
 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 12/16 [2:42:45<54:15, 813.86s/it]  
 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 13/16 [2:56:20<40:41, 813.97s/it]
 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 14/16 [3:09:54<27:07, 813.98s/it]
 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 15/16 [3:23:27<13:33, 813.92s/it]
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [3:37:01<00:00, 813.88s/it]
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [3:37:01<00:00, 813.85s/it]
wandb: uploading artifact run-rzyf8lvh-example_trajectories; uploading artifact qwen-2.5-1.5B-instruct-sft-lora-countdown-deepseek-correct-5k_MelinaLaimon_stream-of-search-ood_countdown_5num_samples
wandb: uploading artifact qwen-2.5-1.5B-instruct-sft-lora-countdown-deepseek-correct-5k_MelinaLaimon_stream-of-search-ood_countdown_5num_samples
wandb:                                                                                
wandb: 
wandb: Run history:
wandb: success_rate_best_of_n ‚ñà‚ñÅ
wandb:      success_rate_mean ‚ñà‚ñÅ
wandb: 
wandb: Run summary:
wandb:           dataset_name MelinaLaimon/stream-...
wandb:                  model qwen-2.5-1.5B-instru...
wandb:                  split countdown_5num
wandb: success_rate_best_of_n 0.01562
wandb:      success_rate_mean 0.01562
wandb:              timestamp 20250406-183148
wandb: 
wandb: üöÄ View run 20250406120048-distributed-eval-qwen-2.5-1.5B-instruct-sft-lora-countdown-deepseek-correct-5k at: https://wandb.ai/yeokch/stream-of-search/runs/rzyf8lvh
wandb: ‚≠êÔ∏è View project at: https://wandb.ai/yeokch/stream-of-search
wandb: Synced 5 W&B file(s), 2 media file(s), 8 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20250406_120201-rzyf8lvh/logs
Success rate for each trial: [0.015625]

Summary:
  Best-of-1 success rate: 0.0156 (2/128)
  Mean success rate across trials: 0.0156

20250404171146-distributed-eval-qwen-2.5-1.5B-instruct-sft-lora-countdown-deepseek-correct-seq8k-1k
20250330162156-distributed-eval-qwen-2.5-1.5B-instruct-sft-lora-countdown-o3-1k
20250402173753-distributed-eval-qwen-2.5-0.5B-instruct-sft-lora-countdown-search-seq8k-5k
20250405100447-distributed-eval-qwen-2.5-0.5B-instruct-sft-lora-countdown-search-seq8k-5k
20250330162156-distributed-eval-qwen-2.5-0.5B-instruct-sft-lora-countdown-o3-1k
20250330162156-distributed-eval-qwen-2.5-0.5B-instruct-sft-lora-countdown-o3-5k
20250330162156-distributed-eval-qwen-2.5-0.5B-instruct-sft-lora-countdown-optimal-1k
20250401223424-distributed-eval-qwen-2.5-0.5B-instruct-sft-lora-countdown-optimal-seq8k-5k
20250330162156-distributed-eval-qwen-2.5-0.5B-instruct-sft-lora-countdown-search-1k
20250330162156-distributed-eval-qwen-2.5-0.5B-instruct-sft-lora-countdown-search-react-1k
20250404020552-distributed-eval-qwen-2.5-0.5B-instruct-sft-lora-countdown-search-react-correct-seq10k-5k
20250406120048-distributed-eval-qwen-2.5-0.5B-instruct-sft-lora-countdown-search-react-correct-seq10k-5k
20250405100447-distributed-eval-qwen-2.5-0.5B-instruct-sft-lora-countdown-search-react-seq8k-5k
20250401223424-distributed-eval-qwen-2.5-1.5B-instruct-sft-lora-countdown-optimal-seq8k-5k
20250401020220-distributed-eval-qwen-2.5-1.5B-instruct-sft-lora-countdown-search-long-1k
20250404235723-distributed-eval-qwen-2.5-1.5B-instruct-sft-lora-countdown-search-react-correct-seq10k-5k
20250405173314-distributed-eval-qwen-2.5-1.5B-instruct-sft-lora-countdown-search-react-seq8k-5k
20250404020552-distributed-eval-qwen-2.5-1.5B-instruct-sft-lora-countdown-search-seq8k-5k
20250401020220-distributed-eval-qwen-2.5-1.5B-instruct-sft-lora-countdown-search-1k
20250405164844-distributed-eval-qwen-2.5-0.5B-instruct-sft-lora-countdown-deepseek-correct-seq8k-1k
20250404235723-distributed-eval-Qwen2.5-1.5B-Instruct
20250404175403-distributed-eval-Qwen2.5-0.5B-Instruct
20250406164110-distributed-eval-qwen-2.5-0.5B-instruct-sft-lora-countdown-deepseek-correct-5k
20250406120048-distributed-eval-qwen-2.5-0.5B-instruct-sft-lora-countdown-deepseek-correct-5k
20250406120048-distributed-eval-qwen-2.5-1.5B-instruct-sft-lora-countdown-deepseek-correct-5k
Processing folder: qwen-2.5-1.5B-instruct-sft-lora-countdown-deepseek-correct-seq8k-1k, model_key: 1.5B-deepseek-correct-seq8k-1k
Added data point: 3num, 1.5B-deepseek-correct-seq8k-1k, success_rate: 0.3828125
Added data point: 5num, 1.5B-deepseek-correct-seq8k-1k, success_rate: 0.0234375
Processing folder: qwen-2.5-1.5B-instruct-sft-lora-countdown-o3-1k, model_key: 1.5B-o3-1k
Processing folder: qwen-2.5-0.5B-instruct-sft-lora-countdown-search-seq8k-5k, model_key: 0.5B-search-seq8k-5k
Added data point: 3num, 0.5B-search-seq8k-5k, success_rate: 0.3359375
Added data point: 5num, 0.5B-search-seq8k-5k, success_rate: 0.0
Processing folder: qwen-2.5-1.5B-instruct-sft-lora-countdown-deepseek-correct-5k, model_key: 1.5B-deepseek-correct-5k
Added data point: 5num, 1.5B-deepseek-correct-5k, success_rate: 0.015625
Processing folder: qwen-2.5-0.5B-instruct-sft-lora-countdown-o3-1k, model_key: 0.5B-o3-1k
Added data point: 3num, 0.5B-o3-1k, success_rate: 0.1171875
Added data point: 5num, 0.5B-o3-1k, success_rate: 0.0
Processing folder: qwen-2.5-0.5B-instruct-sft-lora-countdown-o3-5k, model_key: 0.5B-o3-5k
Added data point: 3num, 0.5B-o3-5k, success_rate: 0.09375
Added data point: 5num, 0.5B-o3-5k, success_rate: 0.0
Processing folder: qwen-2.5-0.5B-instruct-sft-lora-countdown-optimal-1k, model_key: 0.5B-optimal-1k
Added data point: 3num, 0.5B-optimal-1k, success_rate: 0.0390625
Added data point: 5num, 0.5B-optimal-1k, success_rate: 0.0
Processing folder: qwen-2.5-0.5B-instruct-sft-lora-countdown-optimal-seq8k-5k, model_key: 0.5B-optimal-seq8k-5k
Added data point: 3num, 0.5B-optimal-seq8k-5k, success_rate: 0.015625
Added data point: 5num, 0.5B-optimal-seq8k-5k, success_rate: 0.0078125
Processing folder: qwen-2.5-0.5B-instruct-sft-lora-countdown-search-1k, model_key: 0.5B-search-1k
Added data point: 3num, 0.5B-search-1k, success_rate: 0.0859375
Added data point: 5num, 0.5B-search-1k, success_rate: 0.0078125
Processing folder: qwen-2.5-0.5B-instruct-sft-lora-countdown-search-react-1k, model_key: 0.5B-search-react-1k
Added data point: 3num, 0.5B-search-react-1k, success_rate: 0.0078125
Added data point: 5num, 0.5B-search-react-1k, success_rate: 0.0
Processing folder: qwen-2.5-0.5B-instruct-sft-lora-countdown-search-react-correct-seq10k-5k, model_key: 0.5B-search-react-correct-seq10k-5k
Added data point: 5num, 0.5B-search-react-correct-seq10k-5k, success_rate: 0.0
Added data point: 3num, 0.5B-search-react-correct-seq10k-5k, success_rate: 0.0
Processing folder: qwen-2.5-0.5B-instruct-sft-lora-countdown-search-react-seq8k-5k, model_key: 0.5B-search-react-seq8k-5k
Processing folder: qwen-2.5-1.5B-instruct-sft-lora-countdown-optimal-seq8k-5k, model_key: 1.5B-optimal-seq8k-5k
Added data point: 3num, 1.5B-optimal-seq8k-5k, success_rate: 0.046875
Added data point: 5num, 1.5B-optimal-seq8k-5k, success_rate: 0.0078125
Processing folder: qwen-2.5-1.5B-instruct-sft-lora-countdown-search-long-1k, model_key: 1.5B-search-long-1k
Processing folder: qwen-2.5-1.5B-instruct-sft-lora-countdown-search-react-correct-seq10k-5k, model_key: 1.5B-search-react-correct-seq10k-5k
Added data point: 3num, 1.5B-search-react-correct-seq10k-5k, success_rate: 0.625
Added data point: 3num, 1.5B-search-react-correct-seq10k-5k, success_rate: 0.625
Added data point: 5num, 1.5B-search-react-correct-seq10k-5k, success_rate: 0.0
Processing folder: qwen-2.5-1.5B-instruct-sft-lora-countdown-search-react-seq8k-5k, model_key: 1.5B-search-react-seq8k-5k
Added data point: 3num, 1.5B-search-react-seq8k-5k, success_rate: 0.4453125
Added data point: 5num, 1.5B-search-react-seq8k-5k, success_rate: 0.03125
Processing folder: qwen-2.5-1.5B-instruct-sft-lora-countdown-search-seq8k-5k, model_key: 1.5B-search-seq8k-5k
Added data point: 5num, 1.5B-search-seq8k-5k, success_rate: 0.0
Added data point: 3num, 1.5B-search-seq8k-5k, success_rate: 0.578125
Processing folder: qwen-2.5-1.5B-instruct-sft-lora-countdown-search-1k, model_key: 1.5B-search-1k
Processing folder: qwen-2.5-0.5B-instruct-sft-lora-countdown-deepseek-correct-seq8k-1k, model_key: 0.5B-deepseek-correct-seq8k-1k
Added data point: 5num, 0.5B-deepseek-correct-seq8k-1k, success_rate: 0.0078125
Processing folder: qwen-2.5-1.5B-instruct-countdown-baseline, model_key: 1.5B-baseline
Added data point: 3num, 1.5B-baseline, success_rate: 0.03125
Added data point: 5num, 1.5B-baseline, success_rate: 0.0
Processing folder: qwen-2.5-0.5B-instruct-countdown-baseline, model_key: 0.5B-baseline
Added data point: 3num, 0.5B-baseline, success_rate: 0.0
Added data point: 5num, 0.5B-baseline, success_rate: 0.0
Processing folder: qwen-2.5-0.5B-instruct-sft-lora-countdown-deepseek-correct-seq-8k-5k, model_key: 0.5B-deepseek-correct-seq-8k-5k
Added data point: 3num, 0.5B-deepseek-correct-seq-8k-5k, success_rate: 0.4296875
Added data point: 3num, 0.5B-deepseek-correct-seq-8k-5k, success_rate: 0.359375
Added data point: 5num, 0.5B-deepseek-correct-seq-8k-5k, success_rate: 0.0
Processing folder: qwen-2.5-1.5B-instruct-sft-lora-countdown-search-react-seq10k-5k, model_key: 1.5B-search-react-seq10k-5k
Processing folder: qwen-2.5-0.5B-instruct-sft-lora-countdown-deepseek-5k, model_key: 0.5B-deepseek-5k
Processing folder: qwen-2.5-1.5B-instruct-sft-lora-countdown-deepseek-5k, model_key: 1.5B-deepseek-5k
Processing folder: qwen-2.5-1.5B-instruct-sft-lora-countdown-deepseek-correct-seq8k-5k, model_key: 1.5B-deepseek-correct-seq8k-5k
Added data point: 3num, 1.5B-deepseek-correct-seq8k-5k, success_rate: 0.7109375
Added data point: 3num, 1.5B-deepseek-correct-seq8k-5k, success_rate: 0.7109375

Collected data:
3num:
  1.5B-deepseek-correct-seq8k-1k: [0.3828125]
  0.5B-search-seq8k-5k: [0.3359375]
  0.5B-o3-1k: [0.1171875]
  0.5B-o3-5k: [0.09375]
  0.5B-optimal-1k: [0.0390625]
  0.5B-optimal-seq8k-5k: [0.015625]
  0.5B-search-1k: [0.0859375]
  0.5B-search-react-1k: [0.0078125]
  0.5B-search-react-correct-seq10k-5k: [0.0]
  1.5B-optimal-seq8k-5k: [0.046875]
  1.5B-search-react-correct-seq10k-5k: [0.625, 0.625]
  1.5B-search-react-seq8k-5k: [0.4453125]
  1.5B-search-seq8k-5k: [0.578125]
  1.5B-baseline: [0.03125]
  0.5B-baseline: [0.0]
  0.5B-deepseek-correct-seq-8k-5k: [0.4296875, 0.359375]
  1.5B-deepseek-correct-seq8k-5k: [0.7109375, 0.7109375]
5num:
  1.5B-deepseek-correct-seq8k-1k: [0.0234375]
  0.5B-search-seq8k-5k: [0.0]
  1.5B-deepseek-correct-5k: [0.015625]
  0.5B-o3-1k: [0.0]
  0.5B-o3-5k: [0.0]
  0.5B-optimal-1k: [0.0]
  0.5B-optimal-seq8k-5k: [0.0078125]
  0.5B-search-1k: [0.0078125]
  0.5B-search-react-1k: [0.0]
  0.5B-search-react-correct-seq10k-5k: [0.0]
  1.5B-optimal-seq8k-5k: [0.0078125]
  1.5B-search-react-correct-seq10k-5k: [0.0]
  1.5B-search-react-seq8k-5k: [0.03125]
  1.5B-search-seq8k-5k: [0.0]
  0.5B-deepseek-correct-seq8k-1k: [0.0078125]
  1.5B-baseline: [0.0]
  0.5B-baseline: [0.0]
  0.5B-deepseek-correct-seq-8k-5k: [0.0]

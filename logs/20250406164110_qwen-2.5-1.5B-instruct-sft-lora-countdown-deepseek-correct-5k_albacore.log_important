=== GPU INFO BEFORE EVALUATION (2025-04-06 16:41:10) ===
VBoxManage: error: Failed to replace '/cs/student/msc/ml/2024/ycheah/.config/VirtualBox/VirtualBox.xml' with '/cs/student/msc/ml/2024/ycheah/.config/VirtualBox/VirtualBox.xml-tmp' VERR_FILE_NOT_FOUND (File not found.).
VBoxManage: error: /home/vbox/tinderbox/build-VBox-7.0/svn/src/VBox/Main/src-server/VirtualBoxImpl.cpp[4970] (nsresult VirtualBox::i_saveSettings())
VBoxManage: error: Details: code NS_ERROR_FAILURE (0x80004005), component VirtualBoxWrap, interface IVirtualBox, callee nsISupports
VBoxManage: error: Context: "COMSETTER(DefaultMachineFolder)(Bstr(a->argv[1]).raw())" at line 1438 of file VBoxManageMisc.cpp
Sun Apr  6 16:41:10 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 560.35.03              Driver Version: 560.35.03      CUDA Version: 12.6     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA GeForce RTX 4070 ...    On  |   00000000:65:00.0 Off |                  N/A |
|  0%   42C    P8              9W /  285W |     146MiB /  16376MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI        PID   Type   Process name                              GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|    0   N/A  N/A      2778      G   /usr/libexec/Xorg                             117MiB |
|    0   N/A  N/A      3580      G   /usr/bin/gnome-shell                           13MiB |
+-----------------------------------------------------------------------------------------+


=== STARTING EVALUATION ===

=== START TIME: 2025-04-06 16:41:10 ===
=== HOSTNAME: albacore ===
=== COMMAND: ssh -o ServerAliveInterval=60 albacore cd ~/projects/sos/stream-of-search && /cs/student/msc/ml/2024/ycheah/disk/miniconda3/envs/sos1/bin/python ./src/eval_custom.py --adapter 'yeok/qwen-2.5-1.5B-instruct-sft-lora-countdown-deepseek-correct-5k' -n 128 --dataset_name 'MelinaLaimon/stream-of-search-ood' --messages_field 'messages' --temperature 0.7 --batch_size 8 --ctx 8192 --gens 1 --chat_template True --experiment_name '20250406164110-distributed-eval-qwen-2.5-1.5B-instruct-sft-lora-countdown-deepseek-correct-5k' --upload_results True --wandb_project 'stream-of-search' --wandb_entity 'yeokch' ===
wandb: Using wandb-core as the SDK backend.  Please refer to https://wandb.me/wandb-core for more information.
wandb: Currently logged in as: yeokch to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
wandb: Tracking run with wandb version 0.19.8
wandb: Run data is saved locally in /cs/student/projects1/ml/2024/ycheah/projects/sos/stream-of-search/wandb/run-20250406_164133-i3s8lpbc
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run 20250406164110-distributed-eval-qwen-2.5-1.5B-instruct-sft-lora-countdown-deepseek-correct-5k
wandb: ‚≠êÔ∏è View project at https://wandb.ai/yeokch/stream-of-search
wandb: üöÄ View run at https://wandb.ai/yeokch/stream-of-search/runs/i3s8lpbc
Sliding Window Attention is enabled but not implemented for `sdpa`; unexpected results may be encountered.
2025-04-06 16:41:36,041 - INFO - We will use 90% of the memory on device 0 for storing the model, and 10% for the buffer to avoid OOM. You can set `max_memory` in to a higher value to use more memory (at your own risk).
Keys to evaluate: ['countdown_3num', 'countdown_5num']
Adding deepseek instructions to the prompt

  0%|          | 0/16 [00:00<?, ?it/s]
  6%|‚ñã         | 1/16 [03:54<58:38, 234.55s/it]
 12%|‚ñà‚ñé        | 2/16 [11:44<1:27:00, 372.88s/it]
 19%|‚ñà‚ñâ        | 3/16 [23:53<1:56:02, 535.61s/it]
 25%|‚ñà‚ñà‚ñå       | 4/16 [34:41<1:56:01, 580.09s/it]
 31%|‚ñà‚ñà‚ñà‚ñè      | 5/16 [46:51<1:56:15, 634.10s/it]
 38%|‚ñà‚ñà‚ñà‚ñä      | 6/16 [49:24<1:18:24, 470.43s/it]
 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 7/16 [56:22<1:07:58, 453.18s/it]
 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 8/16 [57:03<42:56, 322.03s/it]  
 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 9/16 [1:09:12<52:24, 449.20s/it]
 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 10/16 [1:10:28<33:24, 334.03s/it]
 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 11/16 [1:16:04<27:53, 334.70s/it]
 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 12/16 [1:18:48<18:51, 282.79s/it]
 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 13/16 [1:22:54<13:34, 271.56s/it]
 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 14/16 [1:35:02<13:38, 409.47s/it]
 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 15/16 [1:38:02<05:40, 340.24s/it]
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [1:40:00<00:00, 273.36s/it]
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [1:40:00<00:00, 375.01s/it]
Success rate for each trial: [0.7109375]

Summary:
  Best-of-1 success rate: 0.7109 (91/128)
  Mean success rate across trials: 0.7109

Adding deepseek instructions to the prompt

  0%|          | 0/16 [00:00<?, ?it/s]
  6%|‚ñã         | 1/16 [12:09<3:02:20, 729.37s/it]
 12%|‚ñà‚ñé        | 2/16 [24:18<2:50:12, 729.44s/it]
 19%|‚ñà‚ñâ        | 3/16 [36:28<2:38:02, 729.42s/it]
 25%|‚ñà‚ñà‚ñå       | 4/16 [48:37<2:25:52, 729.37s/it]
 31%|‚ñà‚ñà‚ñà‚ñè      | 5/16 [1:00:47<2:13:44, 729.48s/it]
 38%|‚ñà‚ñà‚ñà‚ñä      | 6/16 [1:12:56<2:01:32, 729.30s/it]
 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 7/16 [1:25:05<1:49:24, 729.36s/it]
 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 8/16 [1:37:19<1:37:26, 730.85s/it]
 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 9/16 [1:49:31<1:25:17, 731.08s/it]
 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 10/16 [2:01:47<1:13:15, 732.54s/it]
 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 11/16 [2:13:58<1:01:01, 732.31s/it]
 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 12/16 [2:26:17<48:56, 734.13s/it]  
 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 13/16 [2:38:28<36:39, 733.28s/it]
 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 14/16 [2:50:42<24:26, 733.46s/it]
 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 15/16 [3:02:51<12:12, 732.13s/it]
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [3:15:00<00:00, 731.26s/it]
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 16/16 [3:15:00<00:00, 731.29s/it]
wandb: uploading artifact run-i3s8lpbc-example_trajectories; uploading artifact qwen-2.5-1.5B-instruct-sft-lora-countdown-deepseek-correct-5k_MelinaLaimon_stream-of-search-ood_countdown_5num_samples
wandb: uploading artifact qwen-2.5-1.5B-instruct-sft-lora-countdown-deepseek-correct-5k_MelinaLaimon_stream-of-search-ood_countdown_5num_samples
wandb:                                                                                
wandb: 
wandb: Run history:
wandb: success_rate_best_of_n ‚ñà‚ñÅ
wandb:      success_rate_mean ‚ñà‚ñÅ
wandb: 
wandb: Run summary:
wandb:           dataset_name MelinaLaimon/stream-...
wandb:                  model qwen-2.5-1.5B-instru...
wandb:                  split countdown_5num
wandb: success_rate_best_of_n 0.00781
wandb:      success_rate_mean 0.00781
wandb:              timestamp 20250406-213645
wandb: 
wandb: üöÄ View run 20250406164110-distributed-eval-qwen-2.5-1.5B-instruct-sft-lora-countdown-deepseek-correct-5k at: https://wandb.ai/yeokch/stream-of-search/runs/i3s8lpbc
wandb: ‚≠êÔ∏è View project at: https://wandb.ai/yeokch/stream-of-search
wandb: Synced 5 W&B file(s), 2 media file(s), 8 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20250406_164133-i3s8lpbc/logs
Success rate for each trial: [0.0078125]

Summary:
  Best-of-1 success rate: 0.0078 (1/128)
  Mean success rate across trials: 0.0078

20250404171146-distributed-eval-qwen-2.5-1.5B-instruct-sft-lora-countdown-deepseek-correct-seq8k-1k
20250330162156-distributed-eval-qwen-2.5-1.5B-instruct-sft-lora-countdown-o3-1k
20250402173753-distributed-eval-qwen-2.5-0.5B-instruct-sft-lora-countdown-search-seq8k-5k
20250405100447-distributed-eval-qwen-2.5-0.5B-instruct-sft-lora-countdown-search-seq8k-5k
20250330162156-distributed-eval-qwen-2.5-0.5B-instruct-sft-lora-countdown-o3-1k
20250330162156-distributed-eval-qwen-2.5-0.5B-instruct-sft-lora-countdown-o3-5k
20250330162156-distributed-eval-qwen-2.5-0.5B-instruct-sft-lora-countdown-optimal-1k
20250401223424-distributed-eval-qwen-2.5-0.5B-instruct-sft-lora-countdown-optimal-seq8k-5k
20250330162156-distributed-eval-qwen-2.5-0.5B-instruct-sft-lora-countdown-search-1k
20250330162156-distributed-eval-qwen-2.5-0.5B-instruct-sft-lora-countdown-search-react-1k
20250404020552-distributed-eval-qwen-2.5-0.5B-instruct-sft-lora-countdown-search-react-correct-seq10k-5k
20250406120048-distributed-eval-qwen-2.5-0.5B-instruct-sft-lora-countdown-search-react-correct-seq10k-5k
20250405100447-distributed-eval-qwen-2.5-0.5B-instruct-sft-lora-countdown-search-react-seq8k-5k
20250401223424-distributed-eval-qwen-2.5-1.5B-instruct-sft-lora-countdown-optimal-seq8k-5k
20250401020220-distributed-eval-qwen-2.5-1.5B-instruct-sft-lora-countdown-search-long-1k
20250404235723-distributed-eval-qwen-2.5-1.5B-instruct-sft-lora-countdown-search-react-correct-seq10k-5k
20250405173314-distributed-eval-qwen-2.5-1.5B-instruct-sft-lora-countdown-search-react-seq8k-5k
20250404020552-distributed-eval-qwen-2.5-1.5B-instruct-sft-lora-countdown-search-seq8k-5k
20250401020220-distributed-eval-qwen-2.5-1.5B-instruct-sft-lora-countdown-search-1k
20250405164844-distributed-eval-qwen-2.5-0.5B-instruct-sft-lora-countdown-deepseek-correct-seq8k-1k
20250404235723-distributed-eval-Qwen2.5-1.5B-Instruct
20250404175403-distributed-eval-Qwen2.5-0.5B-Instruct
20250406164110-distributed-eval-qwen-2.5-1.5B-instruct-sft-lora-countdown-deepseek-correct-5k
20250406164110-distributed-eval-qwen-2.5-0.5B-instruct-sft-lora-countdown-deepseek-correct-5k
Processing folder: qwen-2.5-1.5B-instruct-sft-lora-countdown-deepseek-correct-seq8k-1k, model_key: 1.5B-deepseek-correct-seq8k-1k
Added data point: 3num, 1.5B-deepseek-correct-seq8k-1k, success_rate: 0.3828125
Added data point: 5num, 1.5B-deepseek-correct-seq8k-1k, success_rate: 0.0234375
Processing folder: qwen-2.5-1.5B-instruct-sft-lora-countdown-o3-1k, model_key: 1.5B-o3-1k
Processing folder: qwen-2.5-0.5B-instruct-sft-lora-countdown-search-seq8k-5k, model_key: 0.5B-search-seq8k-5k
Added data point: 3num, 0.5B-search-seq8k-5k, success_rate: 0.3359375
Added data point: 5num, 0.5B-search-seq8k-5k, success_rate: 0.0
Processing folder: qwen-2.5-1.5B-instruct-sft-lora-countdown-deepseek-correct-5k, model_key: 1.5B-deepseek-correct-5k
Added data point: 5num, 1.5B-deepseek-correct-5k, success_rate: 0.0078125
Processing folder: qwen-2.5-0.5B-instruct-sft-lora-countdown-o3-1k, model_key: 0.5B-o3-1k
Added data point: 3num, 0.5B-o3-1k, success_rate: 0.1171875
Added data point: 5num, 0.5B-o3-1k, success_rate: 0.0
Processing folder: qwen-2.5-0.5B-instruct-sft-lora-countdown-o3-5k, model_key: 0.5B-o3-5k
Added data point: 3num, 0.5B-o3-5k, success_rate: 0.09375
Added data point: 5num, 0.5B-o3-5k, success_rate: 0.0
Processing folder: qwen-2.5-0.5B-instruct-sft-lora-countdown-optimal-1k, model_key: 0.5B-optimal-1k
Added data point: 3num, 0.5B-optimal-1k, success_rate: 0.0390625
Added data point: 5num, 0.5B-optimal-1k, success_rate: 0.0
Processing folder: qwen-2.5-0.5B-instruct-sft-lora-countdown-optimal-seq8k-5k, model_key: 0.5B-optimal-seq8k-5k
Added data point: 3num, 0.5B-optimal-seq8k-5k, success_rate: 0.015625
Added data point: 5num, 0.5B-optimal-seq8k-5k, success_rate: 0.0078125
Processing folder: qwen-2.5-0.5B-instruct-sft-lora-countdown-search-1k, model_key: 0.5B-search-1k
Added data point: 3num, 0.5B-search-1k, success_rate: 0.0859375
Added data point: 5num, 0.5B-search-1k, success_rate: 0.0078125
Processing folder: qwen-2.5-0.5B-instruct-sft-lora-countdown-search-react-1k, model_key: 0.5B-search-react-1k
Added data point: 3num, 0.5B-search-react-1k, success_rate: 0.0078125
Added data point: 5num, 0.5B-search-react-1k, success_rate: 0.0
Processing folder: qwen-2.5-0.5B-instruct-sft-lora-countdown-search-react-correct-seq10k-5k, model_key: 0.5B-search-react-correct-seq10k-5k
Added data point: 5num, 0.5B-search-react-correct-seq10k-5k, success_rate: 0.0
Added data point: 3num, 0.5B-search-react-correct-seq10k-5k, success_rate: 0.0
Processing folder: qwen-2.5-0.5B-instruct-sft-lora-countdown-search-react-seq8k-5k, model_key: 0.5B-search-react-seq8k-5k
Processing folder: qwen-2.5-1.5B-instruct-sft-lora-countdown-optimal-seq8k-5k, model_key: 1.5B-optimal-seq8k-5k
Added data point: 3num, 1.5B-optimal-seq8k-5k, success_rate: 0.046875
Added data point: 5num, 1.5B-optimal-seq8k-5k, success_rate: 0.0078125
Processing folder: qwen-2.5-1.5B-instruct-sft-lora-countdown-search-long-1k, model_key: 1.5B-search-long-1k
Processing folder: qwen-2.5-1.5B-instruct-sft-lora-countdown-search-react-correct-seq10k-5k, model_key: 1.5B-search-react-correct-seq10k-5k
Added data point: 3num, 1.5B-search-react-correct-seq10k-5k, success_rate: 0.625
Added data point: 3num, 1.5B-search-react-correct-seq10k-5k, success_rate: 0.625
Added data point: 5num, 1.5B-search-react-correct-seq10k-5k, success_rate: 0.0
Processing folder: qwen-2.5-1.5B-instruct-sft-lora-countdown-search-react-seq8k-5k, model_key: 1.5B-search-react-seq8k-5k
Added data point: 3num, 1.5B-search-react-seq8k-5k, success_rate: 0.4453125
Added data point: 5num, 1.5B-search-react-seq8k-5k, success_rate: 0.03125
Processing folder: qwen-2.5-1.5B-instruct-sft-lora-countdown-search-seq8k-5k, model_key: 1.5B-search-seq8k-5k
Added data point: 5num, 1.5B-search-seq8k-5k, success_rate: 0.0
Added data point: 3num, 1.5B-search-seq8k-5k, success_rate: 0.578125
Processing folder: qwen-2.5-1.5B-instruct-sft-lora-countdown-search-1k, model_key: 1.5B-search-1k
Processing folder: qwen-2.5-0.5B-instruct-sft-lora-countdown-deepseek-correct-seq8k-1k, model_key: 0.5B-deepseek-correct-seq8k-1k
Added data point: 5num, 0.5B-deepseek-correct-seq8k-1k, success_rate: 0.0078125
Processing folder: qwen-2.5-1.5B-instruct-countdown-baseline, model_key: 1.5B-baseline
Added data point: 3num, 1.5B-baseline, success_rate: 0.03125
Added data point: 5num, 1.5B-baseline, success_rate: 0.0
Processing folder: qwen-2.5-0.5B-instruct-countdown-baseline, model_key: 0.5B-baseline
Added data point: 3num, 0.5B-baseline, success_rate: 0.0
Added data point: 5num, 0.5B-baseline, success_rate: 0.0
Processing folder: qwen-2.5-0.5B-instruct-sft-lora-countdown-deepseek-correct-5k, model_key: 0.5B-deepseek-correct-5k
Processing folder: qwen-2.5-1.5B-instruct-sft-lora-countdown-search-react-seq10k-5k, model_key: 1.5B-search-react-seq10k-5k
Processing folder: qwen-2.5-0.5B-instruct-sft-lora-countdown-deepseek-5k, model_key: 0.5B-deepseek-5k
Processing folder: qwen-2.5-1.5B-instruct-sft-lora-countdown-deepseek-5k, model_key: 1.5B-deepseek-5k
Processing folder: qwen-2.5-1.5B-instruct-sft-lora-countdown-deepseek-correct-seq8k-5k, model_key: 1.5B-deepseek-correct-seq8k-5k
Added data point: 3num, 1.5B-deepseek-correct-seq8k-5k, success_rate: 0.7109375
Added data point: 5num, 1.5B-deepseek-correct-seq8k-5k, success_rate: 0.015625
Processing folder: qwen-2.5-0.5B-instruct-sft-lora-countdown-deepseek-correct-seq8k-5k, model_key: 0.5B-deepseek-correct-seq8k-5k
Added data point: 3num, 0.5B-deepseek-correct-seq8k-5k, success_rate: 0.4296875
Added data point: 5num, 0.5B-deepseek-correct-seq8k-5k, success_rate: 0.0078125

Collected data:
3num:
  1.5B-deepseek-correct-seq8k-1k: [0.3828125]
  0.5B-search-seq8k-5k: [0.3359375]
  0.5B-o3-1k: [0.1171875]
  0.5B-o3-5k: [0.09375]
  0.5B-optimal-1k: [0.0390625]
  0.5B-optimal-seq8k-5k: [0.015625]
  0.5B-search-1k: [0.0859375]
  0.5B-search-react-1k: [0.0078125]
  0.5B-search-react-correct-seq10k-5k: [0.0]
  1.5B-optimal-seq8k-5k: [0.046875]
  1.5B-search-react-correct-seq10k-5k: [0.625, 0.625]
  1.5B-search-react-seq8k-5k: [0.4453125]
  1.5B-search-seq8k-5k: [0.578125]
  1.5B-baseline: [0.03125]
  0.5B-baseline: [0.0]
  1.5B-deepseek-correct-seq8k-5k: [0.7109375]
  0.5B-deepseek-correct-seq8k-5k: [0.4296875]
5num:
  1.5B-deepseek-correct-seq8k-1k: [0.0234375]
  0.5B-search-seq8k-5k: [0.0]
  1.5B-deepseek-correct-5k: [0.0078125]
  0.5B-o3-1k: [0.0]
  0.5B-o3-5k: [0.0]
  0.5B-optimal-1k: [0.0]
  0.5B-optimal-seq8k-5k: [0.0078125]
  0.5B-search-1k: [0.0078125]
  0.5B-search-react-1k: [0.0]
  0.5B-search-react-correct-seq10k-5k: [0.0]
  1.5B-optimal-seq8k-5k: [0.0078125]
  1.5B-search-react-correct-seq10k-5k: [0.0]
  1.5B-search-react-seq8k-5k: [0.03125]
  1.5B-search-seq8k-5k: [0.0]
  0.5B-deepseek-correct-seq8k-1k: [0.0078125]
  1.5B-baseline: [0.0]
  0.5B-baseline: [0.0]
  1.5B-deepseek-correct-seq8k-5k: [0.015625]
  0.5B-deepseek-correct-seq8k-5k: [0.0078125]
